<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Defining Functions · Enso Developer Documentation</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="The developer documentation for the Enso compiler, runtime, and IDE..
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Enso.org"><link rel="stylesheet" href="/gitbook/style.css">
<link rel="stylesheet" href="/gitbook/gitbook-plugin-fontsettings/website.css">
<!-- <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css"> -->

<link rel="stylesheet" href="/gitbook/rouge-highlight-colorful.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/gitbook/images/favicon.ico" type="image/x-icon">
        

        
        


        
        
        

        
        
        

        
            <link rel="prev" href="/docs/enso/syntax/top-level.html" />
        

        
            <link rel="next" href="/docs/enso/syntax/function-arguments.html" />
        
    </head>
    <body>
        
        <div class="book"><div class="book-summary">
    <div id="search-searchbar">
    </div>
    <div class="post-list" id="search-hits">
        
      </div>
      <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
var search = instantsearch({
  appId: '3PBI3MMCBE',
  apiKey: '55d673c313b717b7386df8c9418588d4',
  indexName: 'jekyll',
  searchFunction(helper) {
    var container = document.querySelector('#search-hits');
    container.style.display = helper.state.query === '' ? 'none' : '';

    helper.search();
  }
});

var hitTemplate = function(hit) {
  let date = '';
  if (hit.date) {
    date = moment.unix(hit.date).format('MMM D, YYYY');
  }

  let url = `${hit.url}#${hit.anchor}`;

  var title = hit._highlightResult.title.value;

  var content = hit._highlightResult.html.value;

  return `
    <li class="post-item chapter">
      <a href="${url}" class="post-link">${title}</a>
      <div class="post-snippet">${content}</div>
    </li>
  `;
}


search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
    placeholder: 'Search the docs',
    poweredBy: true // This is required if you're on the free Community plan
  })
);

search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

search.start();
</script>

<style>
.ais-search-box {
  max-width: 100%;
  margin-bottom: 15px;
}
.post-item {
  margin-bottom: 30px;
}
.post-link .ais-Highlight {
  color: #111;
  font-style: normal;
  text-decoration: underline;
}
.post-breadcrumbs {
  color: #424242;
  display: block;
}
.post-breadcrumb {
  font-size: 18px;
  color: #424242;
}
.post-breadcrumb .ais-Highlight {
  font-weight: bold;
  font-style: normal;
}
.post-snippet .ais-Highlight {
  color: #2a7ae2;
  font-style: normal;
  font-weight: bold;
}
.post-snippet img {
  display: none;
}

.post-list {
    list-style:none;
    margin:0;
    padding: 10px 15px;
    -webkit-transition:top .5s ease;
    -moz-transition:top .5s ease;
    -o-transition:top .5s ease;
    transition:top .5s ease
}

#search-hits::after {
    content: '';
    display: block;
    height: 1px;
    margin: 7px 0;
    overflow: hidden;
    background: rgba(0,0,0,.07);
}
</style>
    <nav role="navigation">
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="/">
            
                <a href="/">
                    Home
                </a>
            </li>

            <li class="divider"></li>
            
            
            
            
            

            
            
        
            
            <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax ">
                    <a href="/docs/enso/syntax">
                        Go back
                    </a>
                </li>
                <li class="divider"></li>
            
                
             
            
            
            
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/">
                    
                        <a href="/docs/enso/syntax/">
                            
                                Enso&#39;s Syntax
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/encoding.html">
                    
                        <a href="/docs/enso/syntax/encoding.html">
                            
                                Source File Encoding
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/naming.html">
                    
                        <a href="/docs/enso/syntax/naming.html">
                            
                                Naming
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/layout.html">
                    
                        <a href="/docs/enso/syntax/layout.html">
                            
                                Layout Rules
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/imports.html">
                    
                        <a href="/docs/enso/syntax/imports.html">
                            
                                Imports and Exports
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/literals.html">
                    
                        <a href="/docs/enso/syntax/literals.html">
                            
                                Literals
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/assignment.html">
                    
                        <a href="/docs/enso/syntax/assignment.html">
                            
                                Assignment Expressions
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/types.html">
                    
                        <a href="/docs/enso/syntax/types.html">
                            
                                Types and Type Signatures
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/macros.html">
                    
                        <a href="/docs/enso/syntax/macros.html">
                            
                                The Enso Macro Syntax
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/top-level.html">
                    
                        <a href="/docs/enso/syntax/top-level.html">
                            
                                Enso Top-Level Syntax
                            
                        </a>
                    </li>
                
            
            
            
                
                    
                    <li class="chapter active" data-level="1.2" data-path="/docs/enso/syntax/functions.html">
                    
                        <a href="/docs/enso/syntax/functions.html">
                            
                                Defining Functions
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/function-arguments.html">
                    
                        <a href="/docs/enso/syntax/function-arguments.html">
                            
                                Function Arguments
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/projections.html">
                    
                        <a href="/docs/enso/syntax/projections.html">
                            
                                Projections and Field Access
                            
                        </a>
                    </li>
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/syntax/comments.html">
                    
                        <a href="/docs/enso/syntax/comments.html">
                            
                                Comments
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            

            
        
        </ul>
    </nav>
</div>
<div class="book-body"><div class="body-inner">
    <div class="book-header" role="navigation">
        <!-- Title -->
        <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i>
            
                <a href="." >Defining Functions</a>
            
        </h1>
    </div>
    <div class="page-wrapper" tabindex="-1" role="main">
        <div class="page-inner">
            <div id="book-search-results">
                <div class="search-noresults">
                    <section class="normal markdown-section">
                        <h1 id="defining-functions">Defining Functions</h1>

<p>Enso is a purely-functional programming language. As a result it has support for
<a href="https://en.wikipedia.org/wiki/Functional_programming#First-class_and_higher-order_functions">first-class and higher-order functions</a>,
meaning that you can pass functions as arguments to other functions, return
functions from functions, assign them to variables, store them in data
structures and so on.</p>

<p>Functions in Enso are curried by default, meaning that all functions are
actually functions in one argument, but may return functions accepting further
arguments.</p>

<!-- MarkdownTOC levels="2,3" autolink="true" -->

<ul>
  <li><a href="#lambdas">Lambdas</a></li>
  <li><a href="#defining-functions">Defining Functions</a></li>
  <li><a href="#methods">Methods</a></li>
  <li><a href="#universal-call-syntax">Universal Call Syntax</a></li>
  <li><a href="#code-blocks">Code Blocks</a></li>
  <li><a href="#operators">Operators</a>
    <ul>
      <li><a href="#precedence">Precedence</a></li>
      <li><a href="#sections">Sections</a></li>
    </ul>
  </li>
  <li><a href="#mixfix-functions">Mixfix Functions</a></li>
</ul>

<!-- /MarkdownTOC -->

<h2 id="lambdas">Lambdas</h2>

<p>The most primitive non-atom construct in Enso is the lambda. This is an
anonymous function in one argument. A lambda is defined using the <code class="language-plaintext highlighter-rouge">-&gt;</code> operator,
where the left hand side is an argument, and the right hand side is the body of
the function (containing arbitrary code).</p>

<p>Some functional languages such as Haskell allow for the definition of a lambda
with multiple arguments, but in Enso the type signature use of <code class="language-plaintext highlighter-rouge">-&gt;</code>and the
lambda use of <code class="language-plaintext highlighter-rouge">-&gt;</code> are one and the same. We do not want to have to put the
components of a type signature in parentheses, so we only allow one argument
before each arrow.</p>

<ul>
  <li>Lambdas can close over variables in their surrounding scope.</li>
  <li>If you want to define a multi-argument lambda, you can do it by having a
lambda return another lambda (e.g. <code class="language-plaintext highlighter-rouge">a -&gt; b -&gt; a + b</code>).</li>
</ul>

<p>Additionally, lambdas in Enso have the following properties:</p>

<ul>
  <li>The lambda introduces a new scope shared by the left and right operands.</li>
  <li>The left operand introduces a pattern context.</li>
  <li>If a lambda occurs in a pattern context, its left-hand-side identifiers are
introduced into the scope targeted by the outer pattern context. For example,
the following is valid <code class="language-plaintext highlighter-rouge">(a -&gt; b) -&gt; a.default + b</code>.</li>
  <li>Lambdas cannot currently occur in a matching context.</li>
</ul>

<p>Please note that if a later lambda in a chain shadows an earlier lambda (e.g.
<code class="language-plaintext highlighter-rouge">a -&gt; a -&gt; a</code>), the shadowed arguments by that name are inaccessible. If you
want to unify later arguments with previous ones, you must employ the scope
reference rule and write (in this case) <code class="language-plaintext highlighter-rouge">a -&gt; A -&gt; a</code>.</p>

<blockquote>
  <p>The actionables for this section are:</p>

  <ul>
    <li>In the future we want to be able to match on function types, so this
restriction should be relaxed.</li>
    <li>Do we want any automated unification to take place in the shadowing case?</li>
  </ul>
</blockquote>

<h2 id="defining-functions-1">Defining Functions</h2>

<p>A function definition is just syntactic sugar for the definition of a lambda,
and hence has all the properties that a lambda does. Syntactically, functions
are defined in a similar way to variables. The only difference is that the
function name is followed by one or more parameters.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sum</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div></div>

<p>Under the hood, functions are desugared to a lambda assigned to a variable that
binds the function name. This means that:</p>

<ul>
  <li>
    <p>Like any variable, you can use the <code class="language-plaintext highlighter-rouge">:</code> type ascription operator to provide a
user-defined type for the function.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sum</span> <span class="p">:</span> <span class="p">(</span><span class="ss">a: </span><span class="no">Monoid</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
<span class="n">sum</span> <span class="p">:</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">sum</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Functions have an <em>arity</em>. Unlike a single lambda which always has an arity of
one, function arity refers to the number of arguments in the function
definition, which may not always be deduced from the type signature, but may
still be inferred.</p>
  </li>
</ul>

<h2 id="methods">Methods</h2>

<p>Enso makes a distinction between functions and methods. In Enso, a method is a
function where the first argument (known as the <code class="language-plaintext highlighter-rouge">this</code> argument) is associated
with a given atom. Methods are dispatched dynamically based on the type of the
<code class="language-plaintext highlighter-rouge">this</code> argument, while functions are not.</p>

<p>Methods can be defined in Enso in two ways:</p>

<ol>
  <li><strong>In the Body of a Type:</strong> A function defined in the body of a <code class="language-plaintext highlighter-rouge">type</code>
definition is automatically converted to a method on all the atoms defined in
the body of that type definition.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">type</span> <span class="no">Maybe</span> <span class="n">a</span>
    <span class="no">Nothing</span>
    <span class="n">type</span> <span class="no">Just</span> <span class="p">(</span><span class="n">value</span> <span class="p">:</span> <span class="n">a</span><span class="p">)</span>

    <span class="n">isJust</span> <span class="o">=</span> <span class="k">case</span> <span class="n">this</span> <span class="n">of</span>
        <span class="no">Nothing</span> <span class="o">-&gt;</span> <span class="no">False</span>
        <span class="no">Just</span> <span class="n">_</span> <span class="o">-&gt;</span> <span class="no">True</span>
</code></pre></div></div>

<ol>
  <li><strong>As an Extension Method:</strong> A function defined <em>explicitly</em> on an atom counts
as an extension method on that atom. It can be defined on a typeset to apply
to all the atoms within that typeset.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Number</span><span class="p">.</span><span class="nf">floor</span> <span class="o">=</span> <span class="k">case</span> <span class="n">this</span> <span class="n">of</span>
    <span class="no">Integer</span> <span class="o">-&gt;</span> <span class="o">...</span>
    <span class="o">...</span>
</code></pre></div></div>

<ol>
  <li><strong>As a Function with an Explicit <code class="language-plaintext highlighter-rouge">this</code> Argument:</strong> A function defined with
the type of the <code class="language-plaintext highlighter-rouge">this</code> argument specified to be a type.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">floor</span> <span class="p">(</span><span class="n">this</span> <span class="p">:</span> <span class="no">Number</span><span class="p">)</span> <span class="o">=</span> <span class="k">case</span> <span class="n">this</span> <span class="n">of</span>
    <span class="no">Integer</span> <span class="o">-&gt;</span> <span class="o">...</span>
</code></pre></div></div>

<p>If the user does not explicitly specify the <code class="language-plaintext highlighter-rouge">this</code> argument by name when
defining a method (e.g. they use the <code class="language-plaintext highlighter-rouge">Type.name</code> syntax), it is implicitly added
to the start of the argument list.</p>

<h2 id="universal-call-syntax">Universal Call Syntax</h2>

<p>Calling a function or method is, in general, as simple as applying it to some
arguments. However, as Enso supports both methods and functions, it is very
important that users do not have to think about which of the two they are using
when calling it. To that end, Enso supports what is known as Uniform Call Syntax
(UCS).</p>

<ul>
  <li>Where the syntax for calling methods differs from the syntax for calling
functions, there are needless constraints on writing generic code.</li>
  <li>This is a needless constraint as both notations have their advantages.</li>
  <li>Enso has two notations, but one unified semantics.</li>
</ul>

<p>The rules for the uniform syntax call translation in Enso are as follows:</p>

<ol>
  <li>For an expression <code class="language-plaintext highlighter-rouge">t.fn &lt;args&gt;</code>, this is equivalent to <code class="language-plaintext highlighter-rouge">fn t &lt;args&gt;</code>.</li>
  <li>For an expression <code class="language-plaintext highlighter-rouge">fn t &lt;args&gt;</code>, this is equivalent to <code class="language-plaintext highlighter-rouge">t.fn &lt;args&gt;</code>.</li>
</ol>

<h2 id="code-blocks">Code Blocks</h2>

<p>Top-level blocks in the language are evaluated immediately. This means that the
layout of the code has no impact on semantics of the code:</p>

<ul>
  <li>
    <p>This means that the following <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code> are equivalent.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">foo</span> <span class="n">x</span> <span class="n">y</span>

<span class="n">b</span> <span class="o">=</span>
  <span class="n">foo</span> <span class="n">x</span> <span class="n">y</span>
</code></pre></div>    </div>
  </li>
  <li>To suspend blocks, we provide a <code class="language-plaintext highlighter-rouge">suspend</code> function in the standard library.</li>
  <li>
    <p>This function takes any expression as an argument (including a block), and
suspends the execution of that expression such that it is not evaluated until
forced later.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">susp</span> <span class="o">=</span> <span class="n">suspend</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">foo</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
  <span class="n">x</span><span class="p">.</span><span class="nf">do_thing</span>
</code></pre></div>    </div>

    <p>Alternatively, it is sufficient to type the binding for the block as
<code class="language-plaintext highlighter-rouge">Suspended a</code> where <code class="language-plaintext highlighter-rouge">a</code> is the type of the block.</p>

    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">susp</span> <span class="p">:</span> <span class="no">Suspended</span> <span class="n">a</span> <span class="o">=</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">foo</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
  <span class="n">x</span><span class="p">.</span><span class="nf">do_thing</span>
</code></pre></div>    </div>

    <p>It should be noted that this does not yet work.</p>
  </li>
</ul>

<p>The following rules apply to code blocks:</p>

<ul>
  <li>Code blocks are desugared into in-order applications of monadic bind (as in
keeping with the fact that all blocks are monadic contexts).</li>
  <li>If an expression that returns a value is not assigned to an identifier, this
will issue a warning.</li>
  <li>To suppress this warning you can assign it to a blank (<code class="language-plaintext highlighter-rouge">_</code>).</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">test</span> <span class="o">=</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">expr1</span>
    <span class="n">expr2</span>

<span class="c1"># Becomes</span>
<span class="nb">test</span> <span class="o">=</span>
    <span class="n">expr1</span> <span class="o">&gt;&gt;=</span> <span class="p">(</span><span class="n">_</span> <span class="o">-&gt;</span> <span class="n">expr2</span><span class="p">)</span>

<span class="c1"># Equivalent to</span>
<span class="nb">test</span> <span class="o">=</span>
    <span class="n">expr1</span> <span class="o">&gt;&gt;</span> <span class="n">expr2</span>
</code></pre></div></div>

<ul>
  <li>If the trailing line of the block (the return value) is an assignment, it will
return <code class="language-plaintext highlighter-rouge">Nothing</code> as all assignments do.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">foo</span> <span class="o">=</span>
    <span class="n">pat1</span> <span class="o">=</span> <span class="n">expr1</span>

<span class="c1"># Becomes</span>
<span class="n">foo</span> <span class="o">=</span>
    <span class="n">expr1</span> <span class="o">&gt;&gt;=</span> <span class="p">(</span><span class="n">pat1</span> <span class="o">-&gt;</span> <span class="no">Nothing</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="operators">Operators</h2>

<p>In Enso, an operator is a function with a non-alphanumeric name (e.g. <code class="language-plaintext highlighter-rouge">+</code>). We
only support binary operators, with left and right arguments.</p>

<p>Enso provides a significant amount of flexibility for developers who want to
define custom operators. Formally, any sequence of the following characters
forms an operators <code class="language-plaintext highlighter-rouge">.!$%&amp;*+-/&lt;&gt;?^~\</code>. Operator definitions have three main
parts:</p>

<ul>
  <li><strong>Definition:</strong> This defines a function that is called on the arguments
provided to the operator.</li>
  <li><strong>Precedence:</strong> This is an optional block that defines the
<a href="https://en.wikipedia.org/wiki/Order_of_operations">precedence relation</a> for
the operator. Precedence in Enso is specified <em>in relation</em> to existing
operators. If you do not provide this information, no precedence relations
will be defined.</li>
  <li><strong>Associativity:</strong> This is an optional block that defines the
<a href="https://en.wikipedia.org/wiki/Operator_associativity">operator associativity</a>
to be either <code class="language-plaintext highlighter-rouge">left</code>, <code class="language-plaintext highlighter-rouge">right</code>, or <code class="language-plaintext highlighter-rouge">none</code>. If you do not provide this, the
operator’s associativity will default to <code class="language-plaintext highlighter-rouge">left</code>.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="vi">@prec</span>  <span class="p">[</span><span class="o">&gt;</span> <span class="o">*</span><span class="p">,</span> <span class="o">&lt;</span> <span class="err">$</span><span class="p">]</span>
<span class="vi">@assoc</span> <span class="n">left</span>
<span class="o">^</span> <span class="n">a</span> <span class="n">n</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">^</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="precedence">Precedence</h3>

<p>Operator precedence in Enso is a collection of rules that reflect conventions
about which operations to perform first in order to evaluate a given expression
that contains operators. However, operator precedence in Enso differs from many
other programming languages.</p>

<ul>
  <li>Precedence is not set at fixed levels, but is instead defined in relation to
the precedence of other operators.</li>
  <li>Precedence of an operator in Enso depends on whether a particular operator is
surrounded by spaces or not. This means that the precedence of <em>any</em> operator
not surrounded by spaces is always higher than the precedence of any operator
surrounded by spaces. The only exception to this rule is the <code class="language-plaintext highlighter-rouge">,</code> operator,
which retains the same precedence level regardless of whether it is surrounded
by spaces or not.</li>
</ul>

<p>This space-based precedence may seem strange coming from other languages, but it
allows for writing <em>far</em> cleaner code than other functional languages. This is
best demonstrated by example. Consider the following code:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">list</span>       <span class="o">=</span> <span class="mi">1</span> <span class="o">..</span> <span class="mi">100</span>
<span class="n">randomList</span> <span class="o">=</span> <span class="n">each</span> <span class="n">random</span> <span class="n">list</span>
<span class="n">headOfList</span> <span class="o">=</span> <span class="n">take</span> <span class="mi">10</span> <span class="n">randomList</span>
<span class="n">result</span>     <span class="o">=</span> <span class="n">sort</span> <span class="n">headOfList</span>
</code></pre></div></div>

<p>This could easily be refactored to the following one-liner, and then transformed
using UCS to an expression that reads left to right:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">sort</span> <span class="p">(</span><span class="n">take</span> <span class="mi">10</span> <span class="p">(</span><span class="n">each</span> <span class="n">random</span> <span class="p">(</span><span class="mi">1</span> <span class="o">..</span> <span class="mi">100</span><span class="p">)))</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">(((</span><span class="mi">1</span> <span class="o">..</span> <span class="mi">100</span><span class="p">).</span><span class="nf">each</span> <span class="n">random</span><span class="p">).</span><span class="nf">take</span> <span class="mi">10</span><span class="p">).</span><span class="nf">sort</span>
</code></pre></div></div>

<p>This is still quite noisy, however, so using the whitespace-sensitive operator
precedence rules, combined with the fact that the operator <code class="language-plaintext highlighter-rouge">.</code> is a regular
operator, we get the following.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="o">..</span><span class="mi">100</span> <span class="p">.</span> <span class="nf">each</span> <span class="n">random</span> <span class="p">.</span> <span class="nf">take</span> <span class="mi">10</span> <span class="p">.</span> <span class="nf">sort</span>
</code></pre></div></div>

<h3 id="sections">Sections</h3>

<p>An operator section is a nice shorthand for partially applying an operator. It
works as follows.</p>

<ul>
  <li>Where an argument is not applied to an operator, the missing argument is
replaced by an implicit <code class="language-plaintext highlighter-rouge">_</code>.</li>
  <li>The application is then translated based upon the rules for
<a href="/docs/enso/syntax/function-arguments.html#underscore-arguments">underscore arguments</a> described
later.</li>
  <li>The whitespace-based precedence rules discussed above also apply to operator
sections.</li>
</ul>

<h2 id="mixfix-functions">Mixfix Functions</h2>

<p>A mixfix function is a function that is made up of multiple sections. They are
defined using a special syntax, and operate as follows:</p>

<ul>
  <li>They are defined using a ‘split snake case’. The first section is written as
normal, but subsequent sections are prefixed by an underscore (<code class="language-plaintext highlighter-rouge">if c _then a</code>,
for example).</li>
  <li>The layout rules applied to mixfix functions operate as if each section was a
separate operator, allowing you to write an indented block of code after each
section.</li>
</ul>

<p>Probably the best-known example of a mixfix function is <code class="language-plaintext highlighter-rouge">if-then-else</code>, which is
indeed defined in the Enso standard library.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">foo</span> <span class="o">==</span> <span class="n">bar</span> <span class="k">then</span> <span class="n">frob</span> <span class="k">else</span>
    <span class="n">thing1</span>
    <span class="n">thing2</span>
</code></pre></div></div>

                        
                        
                        <a href="https://github.com/enso-org/enso/blob/main/docs/enso/syntax/functions.md">Open this doc on GitHub</a>
                        
                    </section>
                </div>

                 <!--<div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
var search = instantsearch({
  appId: '3PBI3MMCBE',
  apiKey: '55d673c313b717b7386df8c9418588d4',
  indexName: 'jekyll',
  searchFunction(helper) {
    var container = document.querySelector('#search-hits');
    container.style.display = helper.state.query === '' ? 'none' : '';

    helper.search();
  }
});

var hitTemplate = function(hit) {
  let date = '';
  if (hit.date) {
    date = moment.unix(hit.date).format('MMM D, YYYY');
  }

  let url = `${hit.url}#${hit.anchor}`;

  var title = hit._highlightResult.title.value;

  var content = hit._highlightResult.html.value;

  return `
    <li class="post-item chapter">
      <a href="${url}" class="post-link">${title}</a>
      <div class="post-snippet">${content}</div>
    </li>
  `;
}


search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
    placeholder: 'Search the docs',
    poweredBy: true // This is required if you're on the free Community plan
  })
);

search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

search.start();
</script>

<style>
.ais-search-box {
  max-width: 100%;
  margin-bottom: 15px;
}
.post-item {
  margin-bottom: 30px;
}
.post-link .ais-Highlight {
  color: #111;
  font-style: normal;
  text-decoration: underline;
}
.post-breadcrumbs {
  color: #424242;
  display: block;
}
.post-breadcrumb {
  font-size: 18px;
  color: #424242;
}
.post-breadcrumb .ais-Highlight {
  font-weight: bold;
  font-style: normal;
}
.post-snippet .ais-Highlight {
  color: #2a7ae2;
  font-style: normal;
  font-weight: bold;
}
.post-snippet img {
  display: none;
}

.post-list {
    list-style:none;
    margin:0;
    padding: 10px 15px;
    -webkit-transition:top .5s ease;
    -moz-transition:top .5s ease;
    -o-transition:top .5s ease;
    transition:top .5s ease
}

#search-hits::after {
    content: '';
    display: block;
    height: 1px;
    margin: 7px 0;
    overflow: hidden;
    background: rgba(0,0,0,.07);
}
</style>-->
            </div>
        </div>
    </div>
</div>

                <a href="/docs/enso/syntax/top-level.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Enso Top-Level Syntax">
                    <i class="fa fa-angle-left"></i>
                </a>
                

                
                    <a href="/docs/enso/syntax/function-arguments.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Function Arguments">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},
            "sharing": {
                "all": ["facebook", "google", "twitter", "weibo", "instapaper"],
                "facebook": true,
                "google": false,
                "instapaper": false,
                "twitter": true,
                "vk": false,
                "weibo": false
            },
            "theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            }
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Enso Developer Documentation",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "docs/enso/syntax/functions.md",
        "mtime": "",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2020-10-30 11:32:33 +0000"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/gitbook/gitbook.js"></script>
<script src="/gitbook/theme.js"></script>

<script src="/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>

<!-- <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script> --></body>
</html>