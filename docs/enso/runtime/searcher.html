<!DOCTYPE HTML>
<html lang="en" >
    <head><meta charset="UTF-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>Searcher · Enso Developer Documentation</title><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="The developer documentation for the Enso compiler, runtime, and IDE..
"><meta name="generator" content="Jekyll (using style of GitBook 3.2.3)"><meta name="author" content="Enso.org"><link rel="stylesheet" href="/gitbook/style.css">
<link rel="stylesheet" href="/gitbook/gitbook-plugin-fontsettings/website.css">
<!-- <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css"> -->

<link rel="stylesheet" href="/gitbook/rouge-highlight-colorful.css">

<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="/gitbook/images/favicon.ico" type="image/x-icon">
        

        
        


        
        
        

        
        
        

        
            <link rel="prev" href="/docs/enso/runtime/builtin-base-methods.html" />
        

        
    </head>
    <body>
        
        <div class="book"><div class="book-summary">
    <div id="search-searchbar">
    </div>
    <div class="post-list" id="search-hits">
        
      </div>
      <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
var search = instantsearch({
  appId: '3PBI3MMCBE',
  apiKey: '55d673c313b717b7386df8c9418588d4',
  indexName: 'jekyll',
  searchFunction(helper) {
    var container = document.querySelector('#search-hits');
    container.style.display = helper.state.query === '' ? 'none' : '';

    helper.search();
  }
});

var hitTemplate = function(hit) {
  let date = '';
  if (hit.date) {
    date = moment.unix(hit.date).format('MMM D, YYYY');
  }

  let url = `${hit.url}#${hit.anchor}`;

  var title = hit._highlightResult.title.value;

  var content = hit._highlightResult.html.value;

  return `
    <li class="post-item chapter">
      <a href="${url}" class="post-link">${title}</a>
      <div class="post-snippet">${content}</div>
    </li>
  `;
}


search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
    placeholder: 'Search the docs',
    poweredBy: true // This is required if you're on the free Community plan
  })
);

search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

search.start();
</script>

<style>
.ais-search-box {
  max-width: 100%;
  margin-bottom: 15px;
}
.post-item {
  margin-bottom: 30px;
}
.post-link .ais-Highlight {
  color: #111;
  font-style: normal;
  text-decoration: underline;
}
.post-breadcrumbs {
  color: #424242;
  display: block;
}
.post-breadcrumb {
  font-size: 18px;
  color: #424242;
}
.post-breadcrumb .ais-Highlight {
  font-weight: bold;
  font-style: normal;
}
.post-snippet .ais-Highlight {
  color: #2a7ae2;
  font-style: normal;
  font-weight: bold;
}
.post-snippet img {
  display: none;
}

.post-list {
    list-style:none;
    margin:0;
    padding: 10px 15px;
    -webkit-transition:top .5s ease;
    -moz-transition:top .5s ease;
    -o-transition:top .5s ease;
    transition:top .5s ease
}

#search-hits::after {
    content: '';
    display: block;
    height: 1px;
    margin: 7px 0;
    overflow: hidden;
    background: rgba(0,0,0,.07);
}
</style>
    <nav role="navigation">
        <ul class="summary">
            
            <li class="chapter" data-level="1.1" data-path="/">
            
                <a href="/">
                    Home
                </a>
            </li>

            <li class="divider"></li>
            
            
            
            
            

            
            
        
            
            <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime ">
                    <a href="/docs/enso/runtime">
                        Go back
                    </a>
                </li>
                <li class="divider"></li>
            
                
             
            
            
            
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/">
                    
                        <a href="/docs/enso/runtime/">
                            
                                Enso Runtime
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/caching.html">
                    
                        <a href="/docs/enso/runtime/caching.html">
                            
                                Caching
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/demand-analysis.html">
                    
                        <a href="/docs/enso/runtime/demand-analysis.html">
                            
                                Demand Analysis
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/function-call-flow.html">
                    
                        <a href="/docs/enso/runtime/function-call-flow.html">
                            
                                Function Calling Flow
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/runtime-features.html">
                    
                        <a href="/docs/enso/runtime/runtime-features.html">
                            
                                Runtime Features
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/unbounded-recursion.html">
                    
                        <a href="/docs/enso/runtime/unbounded-recursion.html">
                            
                                Unbounded Recursion
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/execution-server-flow.html">
                    
                        <a href="/docs/enso/runtime/execution-server-flow.html">
                            
                                Execution Server Flow
                            
                        </a>
                    </li>
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/instruments.html">
                    
                        <a href="/docs/enso/runtime/instruments.html">
                            
                                Instruments
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter" data-level="1.1" data-path="/docs/enso/runtime/builtin-base-methods.html">
                    
                        <a href="/docs/enso/runtime/builtin-base-methods.html">
                            
                                Builtin Base Methods
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
                    
                    <li class="chapter active" data-level="1.2" data-path="/docs/enso/runtime/searcher.html">
                    
                        <a href="/docs/enso/runtime/searcher.html">
                            
                                Searcher
                            
                        </a>
                    </li>
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            
            
                
            
            

            
        
        </ul>
    </nav>
</div>
<div class="book-body"><div class="body-inner">
    <div class="book-header" role="navigation">
        <!-- Title -->
        <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i>
            
                <a href="." >Searcher</a>
            
        </h1>
    </div>
    <div class="page-wrapper" tabindex="-1" role="main">
        <div class="page-inner">
            <div id="book-search-results">
                <div class="search-noresults">
                    <section class="normal markdown-section">
                        <h1 id="searcher">Searcher</h1>

<p>The language auto-completion feature requires an ability to search the codebase
using different search criteria. This document describes the Searcher module,
which consists of the suggestions database and the ranking algorithm for
ordering the results.</p>

<!-- MarkdownTOC levels="2,3" autolink="true" -->

<ul>
  <li><a href="#suggestions-database">Suggestions Database</a>
    <ul>
      <li><a href="#static-analysis">Static Analysis</a></li>
      <li><a href="#runtime-inspection">Runtime Inspection</a></li>
      <li><a href="#search-indexes">Search Indexes</a></li>
    </ul>
  </li>
  <li><a href="#results-ranking">Results Ranking</a></li>
</ul>

<!-- /MarkdownTOC -->

<h2 id="suggestions-database">Suggestions Database</h2>

<p>Suggestions database holds entries for fulfilling the auto-completion requests
with additional indexes used to answer the different search criteria. The
database is populated partially by analyzing the sources and enriched with the
extra information from the runtime.</p>

<p>API data types for the suggestions database are specified in the
<a href="/docs/enso/language-server/protocol-language-server.html">Language Server Message Specification</a>
document.</p>

<h3 id="database-structure">Database Structure</h3>

<p>Implementation utilizes the SQLite database.</p>

<p>Database is created per project and the database file stored in the project
directory. That way the index can be preserved between the IDE restarts.</p>

<h4 id="suggestions-table">Suggestions Table</h4>

<p>Suggestions table stores suggestion entries.</p>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">id</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the unique identifier</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">externalId</code></td>
      <td><code class="language-plaintext highlighter-rouge">UUID</code></td>
      <td>the external id from the IR</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">kind</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the type of suggestion entry, i.e. Atom, Method, Function, or Local</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">module</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the module name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the suggestion name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">self_type</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the self type of the Method</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">return_type</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the return type of the entry</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">scope_start</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the start position of the definition scope</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">scope_end</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the end position of the definition scope</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">documentation</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the documentation string</td>
    </tr>
  </tbody>
</table>

<h4 id="arguments-table">Arguments Table</h4>

<p>Arguments table stores all suggestion arguments with <code class="language-plaintext highlighter-rouge">suggestion_id</code> foreign
key.</p>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">id</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the unique identifier</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">suggestion_id</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the suggestion key this argument relates to</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">index</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the argument position in the arguments list</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the argument name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">type</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the argument type; const ‘Any’ is used to specify generic types</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">is_suspended</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>indicates whether the argument is lazy</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">has_defult</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>indicates whether the argument has default value</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">default_value</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the optional default value</td>
    </tr>
  </tbody>
</table>

<h4 id="suggestions-version-table">Suggestions Version Table</h4>

<p>Versions table has a single row with the current database version. The version
is updated on every change in the suggestions table.</p>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">id</code></td>
      <td><code class="language-plaintext highlighter-rouge">INTEGER</code></td>
      <td>the unique identifier representing the currend database version</td>
    </tr>
  </tbody>
</table>

<h4 id="file-versions-table">File Versions Table</h4>

<p>Keeps track of SHA versions of the opened files.</p>

<table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">path</code></td>
      <td><code class="language-plaintext highlighter-rouge">TEXT</code></td>
      <td>the unique identifier of the file</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">digest</code></td>
      <td><code class="language-plaintext highlighter-rouge">BLOB</code></td>
      <td>the SHA hash of the file contents</td>
    </tr>
  </tbody>
</table>

<h3 id="static-analysis">Static Analysis</h3>

<p>The database is filled by analyzing the Intermediate Representation (<code class="language-plaintext highlighter-rouge">IR</code>)
parsed from the source.</p>

<p>Language constructs for suggestions database extracted from the <code class="language-plaintext highlighter-rouge">IR</code>:</p>

<ul>
  <li>Atoms</li>
  <li>Methods</li>
  <li>Functions</li>
  <li>Local assignments</li>
  <li>Documentation</li>
</ul>

<p>In addition, it holds the locality information for each entry. Locality
information specifies the scope where the node was defined, which is used in the
results <a href="#results-ranking">ranking</a> algorithm.</p>

<h3 id="runtime-inspection">Runtime Inspection</h3>

<p>The <code class="language-plaintext highlighter-rouge">IR</code> is missing information about the types. Runtime instrumentation is used
to capture the types and refine the database entries.</p>

<p>Information for suggestions database gathered in runtime:</p>

<ul>
  <li>Types</li>
</ul>

<h3 id="search-indexes">Search Indexes</h3>

<p>The database allows searching the entries by the following criteria, applying
the <a href="#results-ranking">ranking</a> algorithm:</p>

<ul>
  <li>name</li>
  <li>type</li>
  <li>documentation text</li>
  <li>documentation tags</li>
</ul>

<h2 id="results-ranking">Results Ranking</h2>

<p>The search result has an intrinsic ranking based on the scope and the type.</p>

<h3 id="scope">Scope</h3>

<p>The results from the local scope have the highest rank in the search result. As
the scope becomes wider, the rank decreases.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">const_x</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">main</span> <span class="o">=</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">foo</span> <span class="n">x</span> <span class="o">=</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">calculate</span> <span class="c1">#</span>
</code></pre></div></div>

<p>For example, when completing the argument of <code class="language-plaintext highlighter-rouge">calculate: Number -&gt; Number</code>
function, the search results will have the order of: <code class="language-plaintext highlighter-rouge">x2</code> &gt; <code class="language-plaintext highlighter-rouge">x1</code> &gt; <code class="language-plaintext highlighter-rouge">const_x</code>.</p>

<h3 id="type">Type</h3>

<p>Suggestions based on the type are selected by matching with the string runtime
type representation.</p>

<h2 id="implementation">Implementation</h2>

<p>The searcher primarily consists of:</p>

<ul>
  <li>Suggestions database that stores suggestion entries and SHA hashes of the
opened file contents.</li>
  <li>Search requests handler that serves search and capability requests, and
listens to the notifications from the runtime.</li>
  <li>Suggestion builder (aka <em>indexer</em>) that extracts suggestion entries from <code class="language-plaintext highlighter-rouge">IR</code>
in compile time.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
                                  +--------------------------------+
                                  |         SuggestionsDB          |
                                  +-----------------+--------------+
                                  | SuggestionsRepo | VersionsRepo |
                                  +----+------------+---------+----+
                                       ^                      ^
                                       |                      |
            Capability,Search          v                      v
 +--------+      Request     +---------+----------+        +--+------------------+
 | Client +&lt;----------------&gt;+ SuggestionsHandler |        | CollaborativeBuffer |
 +--------+ Database Update  +---------+----------+        +-------------------+-+
            Notifications              ^                  OpenFileNotification |
                                       |                  (isIndexed)          |
                                       |                                       v
                             +---------+---------------------------------------+-------+
                             |                   RuntimeConnector                      |
                             +----+----------+---------------------------------+-------+
                                  ^          ^                                 |
        ExpressionValuesComputed  |          |  SuggestionsDBUpdate            |
                                  |          |                                 |
               +------------------+--+    +--+----------------+                |
               | ExecutionInstrument |    | EnsureCompiledJob |           +----+------+
               +---------------------+    +-------------------+           |  Module   |
                                          |                   | (re)index +-----------+
                                          | SuggestionBuilder +-----------+ isIndexed |
                                          |                   |           +-----------+
                                          +-------------------+

</code></pre></div></div>

<h3 id="indexing">Indexing</h3>

<p>Indexing is a process of extracting suggestions information from the <code class="language-plaintext highlighter-rouge">IR</code>. To
keep the index in the consistent state, the language server tracks SHA versions
of all opened files in the suggestions database.</p>

<ul>
  <li>When the user opens a file, we compare its SHA hash with the saved digest. If
they don’t match, we mark the file for re-index by setting the corresponding
flag in the OpenFile notification sent to the runtime. On receive, the runtime
marks the module as not indexed.</li>
  <li>When the file is compiled, we check the indexed flag on the module. If the
module has not been indexed yet, we send all suggestions extracted from the IR
as a ReIndexed update to the language server. If the module has been indexed,
we only send suggestions that have been affected by the recent edits as a
Database update.</li>
  <li>When the language server receives ReIndexed update, it removes all suggestions
related to this module, applies newly received updates, and sends a combined
update of removed and added entries to the subscribed users. When the language
server receives a regular Database update, it applies the update on the
database and sends the appropriate updates to the subscribers.</li>
  <li>When the user deletes a file, we remove all entries with the corresponding
module from the database and update the users.</li>
</ul>

<h3 id="suggestion-builder">Suggestion Builder</h3>

<p>The suggestion builder takes part in the indexing process. It extracts
suggestions from the compiled <code class="language-plaintext highlighter-rouge">IR</code>. It also converts <code class="language-plaintext highlighter-rouge">IR</code> locations represented
as an absolute char indexes (from the beginning of the file) to a position
relative to a line used in the rest of the project.</p>

<h3 id="runtime-instrumentation">Runtime Instrumentation</h3>

<p>Apart from the type ascriptions, we can only get the return types of expressions
in runtime. On the module execution, the language server listens to the
<code class="language-plaintext highlighter-rouge">ExpressionValuesComputed</code> notifications sent from the runtime, which contain
the external id and the actual return type. Then the language server uses
external id as a key to update return types in the database.</p>

<h3 id="search-requests">Search Requests</h3>

<p>The search request handler has direct access to the database. The completion
request is more complicated then others. To query the database, it needs to
convert the requested file path to the module name. To do this, on startup, the
language server loads the package definition from the root directory and obtains
the project name. Then, having the project name and the root directory path, it
can recover the module name from the requested file path.</p>

<p>The project name can be changed with the refactoring <code class="language-plaintext highlighter-rouge">renameProject</code> command. To
cover this case, the request handler listens to the <code class="language-plaintext highlighter-rouge">ProjectNameChanged</code> event
and updates the project name accordingly.</p>

                        
                        
                        <a href="https://github.com/enso-org/enso/blob/main/docs/enso/runtime/searcher.md">Open this doc on GitHub</a>
                        
                    </section>
                </div>

                 <!--<div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
var search = instantsearch({
  appId: '3PBI3MMCBE',
  apiKey: '55d673c313b717b7386df8c9418588d4',
  indexName: 'jekyll',
  searchFunction(helper) {
    var container = document.querySelector('#search-hits');
    container.style.display = helper.state.query === '' ? 'none' : '';

    helper.search();
  }
});

var hitTemplate = function(hit) {
  let date = '';
  if (hit.date) {
    date = moment.unix(hit.date).format('MMM D, YYYY');
  }

  let url = `${hit.url}#${hit.anchor}`;

  var title = hit._highlightResult.title.value;

  var content = hit._highlightResult.html.value;

  return `
    <li class="post-item chapter">
      <a href="${url}" class="post-link">${title}</a>
      <div class="post-snippet">${content}</div>
    </li>
  `;
}


search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-searchbar',
    placeholder: 'Search the docs',
    poweredBy: true // This is required if you're on the free Community plan
  })
);

search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits',
    templates: {
      item: hitTemplate
    }
  })
);

search.start();
</script>

<style>
.ais-search-box {
  max-width: 100%;
  margin-bottom: 15px;
}
.post-item {
  margin-bottom: 30px;
}
.post-link .ais-Highlight {
  color: #111;
  font-style: normal;
  text-decoration: underline;
}
.post-breadcrumbs {
  color: #424242;
  display: block;
}
.post-breadcrumb {
  font-size: 18px;
  color: #424242;
}
.post-breadcrumb .ais-Highlight {
  font-weight: bold;
  font-style: normal;
}
.post-snippet .ais-Highlight {
  color: #2a7ae2;
  font-style: normal;
  font-weight: bold;
}
.post-snippet img {
  display: none;
}

.post-list {
    list-style:none;
    margin:0;
    padding: 10px 15px;
    -webkit-transition:top .5s ease;
    -moz-transition:top .5s ease;
    -o-transition:top .5s ease;
    transition:top .5s ease
}

#search-hits::after {
    content: '';
    display: block;
    height: 1px;
    margin: 7px 0;
    overflow: hidden;
    background: rgba(0,0,0,.07);
}
</style>-->
            </div>
        </div>
    </div>
</div>

                <a href="/docs/enso/runtime/builtin-base-methods.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Builtin Base Methods">
                    <i class="fa fa-angle-left"></i>
                </a>
                

                
            
            </div>

            <script>
            var gitbook = gitbook || [];
            gitbook.push(function() {
                gitbook.page.hasChanged({
    "page": {
        "title": "Introduction",
        "level": "1.1",
        "depth": 1,
        
        "dir": "ltr"
    },    "config": {
        "plugins": ["fontsettings", "highlight", "livereload", "lunr", "search", "sharing", "theme-default", "livereload"],
        "styles": {
            "ebook": "styles/ebook.css",
            "epub": "styles/epub.css",
            "mobi": "styles/mobi.css",
            "pdf": "styles/pdf.css",
            "print": "styles/print.css",
            "website": "styles/website.css"
        },
        "pluginsConfig": {
            "fontsettings": {
                "family": "sans",
                "size": 2,
                "theme": "white"
            },
            "highlight": {},
            "livereload": {},
            "lunr": {
                "ignoreSpecialCharacters": false,
                "maxIndexSize": 1000000
            },
            "search": {},
            "sharing": {
                "all": ["facebook", "google", "twitter", "weibo", "instapaper"],
                "facebook": true,
                "google": false,
                "instapaper": false,
                "twitter": true,
                "vk": false,
                "weibo": false
            },
            "theme-default": {
                "showLevel": false,
                "styles": {
                    "ebook": "styles/ebook.css",
                    "epub": "styles/epub.css",
                    "mobi": "styles/mobi.css",
                    "pdf": "styles/pdf.css",
                    "print": "styles/print.css",
                    "website": "styles/website.css"
                }
            }
        },
        "theme": "default",
        "author": "Tao He",
        "pdf": {
            "pageNumbers": true,
            "fontSize": 12,
            "fontFamily": "Arial",
            "paperSize": "a4",
            "chapterMark": "pagebreak",
            "pageBreaksBefore": "/",
            "margin": {
                "right": 62,
                "left": 62,
                "top": 56,
                "bottom": 56
            }
        },
        "structure": {
            "langs": "LANGS.md",
            "readme": "README.md",
        },
        "variables": {},
        "title": "Enso Developer Documentation",
        "language": "en",
        "gitbook": "*"
    },
    "file": {
        "path": "docs/enso/runtime/searcher.md",
        "mtime": "",
        "type": "markdown"
    },
    "gitbook": {
        "version": "3.2.3",
        "time": "2020-08-04 10:33:02 +0000"
    },
    "basePath": "",
    "book": {
        "language": ""
    }
});
            });
            </script>
        </div><script src="/gitbook/gitbook.js"></script>
<script src="/gitbook/theme.js"></script>

<script src="/gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>

<!-- <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
<script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
<script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
<script src="../gitbook/gitbook-plugin-search/search.js"></script> --></body>
</html>